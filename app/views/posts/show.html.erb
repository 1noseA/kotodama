<div class="container">
  <div class="row">
    <div class="col-md-10 p-5 my-5 mx-auto bg-light rounded">
      <div class="mb-3">
        <p class="mb-4">言葉<br><%= @post.word %></p>
        <hr width="100%" align="center">
        <p>引用元　　：　<%= @post.source %></p>
        <p>人名　　　：　<%= @post.who %></p>
        <p>カテゴリー：　<%= @post.category %></p>
      </div>

      <%# お気に入りボタン %>
      <span>
        <% if @post.favorited_by?(current_user) %>
          <%= link_to post_favorites_path(@post), method: :delete do %>
            <i class="fas fa-heart" aria-hidden="true" style="color: red;"></i>
            <%= @post.favorites.count %>
          <% end %>
        <% else %>
          <%= link_to post_favorites_path(@post), method: :post do %>
            <i class="far fa-heart" aria-hidden="true"></i>
            <%= @post.favorites.count %>
          <% end %>
        <% end %>
      </span>

      <%# SNSシェアボタン %>
      <span><%= social_share_button_tag (@post.word) %></span>

      <hr width="100%" align="center">

      <p class="my-4">
        エピソード<br><%= @post.episode %><br>
        ジャンル　：　<%= @post.genre %>
      </p>

      <hr width="100%" align="center">

      <p class="my-4">投稿者
        <% if @post.user.image.present? %>
          <%= image_tag @post.user.image.to_s, size: "100x100", class: "user-image" %>
        <% else %>
          <%= image_tag "default.jpg", size: "100x100", class: "user-image" %>
        <% end %>
        <%= @post.user.name %>
      </p>
      <% if @post.user == current_user %>
        <%= link_to "編集する", edit_post_path(@post), class: "btn btn-update" %>
        <%= link_to "削除する",post_path(@post),method: :delete, class: "btn btn-delete", data: { confirm: "削除しますか?" } %>
      <% end %>
    </div>

    <%# コメント一覧 %>
    <div class="col-md-10 mx-auto">
      <p>コメント（全<%= @post.comments.count %>件）</p>
        <% @post.comments.each do |comment| %>
          <table class="table">
            <tr>
              <td class="w-25">
                <% if @post.user.image.present? %>
                  <%= image_tag @post.user.image.to_s, size: "50x50", class: "user-image" %>
                <% else %>
                  <%= image_tag "default.jpg", size: "50x50", class: "user-image" %>
                <% end %><br>
                <%= comment.user.name %>
              </td>
              <td>
                <%= comment.created_at.strftime('%Y/%m/%d') %><br>
                <%= simple_format(comment.body) %>
              </td>
            </tr>
          </table>
        <% end %>

      <%# コメントフォーム %>
      <div class="comment_form text-center my-4">
        <%= form_for [@post, @comment] do |f| %>
          <%= f.text_area :body, placeholder: "コメントをここに", class: "w-75" %><br>
            <%= f.submit "コメントする", class: "btn btn-add" %>
        <% end %>
      </div>
    </div>
  </div>
</div>
